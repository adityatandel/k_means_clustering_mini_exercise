---
title: 'Project: K-Means Clustering Mini-Project'
output: html_document
---
# Exercise 1: Remove the first column from the data and scale
# it using the scale() function

```{r}
wine$Type<-NULL
scale_wine <- scale(wine)
```

##          Alcohol       Malic         Ash   Alcalinity   Magnesium      Phenols    Flavanoids Nonflavanoids Proanthocyanins
##  [1,]  1.51434077 -0.56066822  0.23139979 -1.166303174  1.90852151  0.806721729  1.0319080692   -0.65770780      1.22143845
##  [2,]  0.24559683 -0.49800856 -0.82566722 -2.483840525  0.01809398  0.567048088  0.7315652835   -0.81841060     -0.54318872
##  [3,]  0.19632522  0.02117152  1.10621386 -0.267982252  0.08810981  0.806721729  1.2121137407   -0.49700500      2.12995937
##  [4,]  1.68679140 -0.34583508  0.48655389 -0.806974805  0.92829983  2.484437221  1.4623993954   -0.97911340      1.02925134
##  [5,]  0.29486844  0.22705328  1.83522559  0.450674485  1.27837900  0.806721729  0.6614853002    0.22615759      0.40027531
##  [6,]  1.47738706 -0.51591132  0.30430096 -1.286079296  0.85828399  1.557699140  1.3622851335   -0.17559941      0.66234866
##  [7,]  1.71142720 -0.41744613  0.30430096 -1.465743481 -0.26196936  0.327374446  0.4912910549   -0.49700500      0.67982021
##  [8,]  1.30493643 -0.16680747  0.88751034 -0.567422559  1.48842650  0.487156874  0.4812796287   -0.41665360     -0.59560339
##  [9,]  2.25341491 -0.62332789 -0.71631546 -1.645407665 -0.19195352  0.806721729  0.9518166597   -0.57735640      0.67982021
## [10,]  1.05857838 -0.88291793 -0.35180959 -1.046527051 -0.12193769  1.094330099  1.1220109049   -1.13981619      0.45268998
## [11,]  1.35420804 -0.15785609 -0.24245783 -0.447646437  0.36817315  1.046395371  1.2922051502   -1.13981619      1.37868246
## [12,]  1.37884384 -0.76654998 -0.16955666 -0.806974805 -0.33198519 -0.151972837  0.4011882192   -0.81841060     -0.03651359
## [13,]  0.92308146 -0.54276546  0.15849862 -1.046527051 -0.75208020  0.487156874  0.7315652835   -0.57735640      0.38280376
## [14,]  2.15487169 -0.54276546  0.08559744 -2.423952463 -0.61204853  1.286069013  1.6626279192    0.54756319      2.12995937
## [15,]  1.69910930 -0.41744613  0.04914686 -2.244288279  0.15812565  1.605633868  1.6125707883   -0.57735640      2.39203271
## [16,]  0.77526663 -0.47115441  1.21556562 -0.687198682  0.85828399  0.886612943  0.8817366764   -0.49700500     -0.22870071
## [17,]  1.60056608 -0.37268923  1.28846679  0.151234178  1.41841067  0.806721729  1.1119994787   -0.25595080      0.66234866
## [18,]  1.02162467 -0.68598755  0.92396093  0.151234178  1.06833150  1.046395371  1.3722965597    0.30650899      0.22555975
## [19,]  1.46506916 -0.66808479  0.41365272 -0.896806897  0.57822065  1.605633868  1.9029021478   -0.33630220      0.47016154
## [20,]  0.78758453  0.68357369  0.70525741 -1.286079296  1.13834733  0.646939302  1.0018737906   -1.54157319      0.12073042
## [21,]  1.30493643 -0.63227927 -0.31535901 -1.046527051  1.83850567  1.126286585  1.1420337573   -0.97911340      0.88947889
## [22,] -0.08698653  1.31017034  1.03331269 -0.267982252  0.15812565  0.183570261  0.3811653668   -0.89876200      0.67982021
## [23,]  0.87380985 -0.42639751 -0.02375431 -0.866862867  0.08810981  0.503135117  0.8517023978   -0.73805920      0.17314508
## [24,] -0.18552975 -0.65913341  0.55945507 -0.507534498 -0.33198519  0.295417961  0.3411196621   -0.81841060     -0.22870071
## [25,]  0.61513390 -0.47115441  0.88751034  0.151234178 -0.26196936  0.375309174  0.5813938906   -0.65770780      0.12073042
## [26,]  0.06082829 -0.25632128  3.11099611  1.648435713  1.69847400  0.535091602  0.6514738740    0.86896878      0.57499088
## [27,]  0.47963697 -0.50695994  0.92396093 -1.016583020 -0.47201686  0.886612943  0.9117709549   -0.17559941     -0.24617226
## [28,]  0.36877585 -0.55171684 -0.82566722 -0.747086744 -0.40200103  0.167592018  0.1609139906   -0.73805920     -0.42088782
## [29,]  1.07089628 -0.39059199  1.58007149 -0.028430007  0.50820482  1.046395371  0.9418052335    0.06545479      0.29544598
## [30,]  1.25566482 -0.58752236 -0.57051311 -1.046527051 -0.26196936  0.567048088  0.3010739573   -0.81841060      0.67982021
## [31,]  0.89844565 -0.74864721  1.21556562  0.899834945  0.08810981  1.126286585  1.2221251668   -0.57735640      1.37868246
## [32,]  0.71367712 -0.60542512 -0.02375431 -0.118262099  0.43818899  0.902591186  1.1620566097   -1.13981619      0.62740554
## [33,]  0.83685614 -0.45325165 -0.02375431 -0.687198682  0.29815732  0.199548504  0.6614853002    0.46721179      0.66234866
## [34,]  0.93539936 -0.72179307  1.21556562  0.001514024  2.25860068  1.046395371  0.7115424311    1.11002298     -0.42088782
## [35,]  0.62745180 -0.48010579  1.03331269 -0.148206130  0.71825232  0.087700804  0.5013024811   -0.57735640     -0.08892826
## [36,]  0.59049809 -0.47115441  0.15849862  0.300954331  0.01809398  0.646939302  0.9518166597   -0.81841060      0.47016154
## [37,]  0.34414005 -0.62332789  1.72587383 -1.196247204  0.71825232  0.487156874  0.6514738740   -0.17559941     -0.40341627
## [38,]  0.06082829 -0.61437650  0.66880683 -0.447646437 -0.12193769  0.247483232  0.4011882192   -0.57735640     -0.26364382
## [39,]  0.08546410 -0.74864721 -0.97146956 -1.196247204 -0.12193769  0.167592018  0.6114281692   -0.65770780     -0.38594471
## [40,]  1.50202286  1.48024658  0.52300448 -1.884959911  1.97853734  1.126286585  1.0118852168   -1.30051899      0.85453577
## [41,]  0.68904131 -0.56066822 -0.20600725 -0.986638989  1.20836316  1.365960227  1.2621708716   -0.17559941      1.30879623
## [42,]  0.50427278  1.34597587 -0.89856839 -0.208094191 -0.68206436  0.247483232  0.6514738740   -0.73805920     -0.19375759
## [43,]  1.08321419 -0.39954337  0.81460917 -1.345967358  0.08810981  1.525742654  1.5324793788   -1.54157319      0.19061664
## [44,]  0.29486844  1.47129519 -0.27890842 -0.597366590  0.22814148  0.551069845  0.6014167430   -0.33630220      0.12073042
## [45,]  0.06082829 -0.50695994 -0.97146956 -0.747086744  0.50820482  1.126286585  0.9718395121   -0.65770780      0.76717799
## [46,]  1.48970496  1.52500348  0.26785038 -0.178150160  0.78826816  0.886612943  0.6214395954   -0.49700500     -0.59560339
## [47,]  1.69910930  1.12219135 -0.31535901 -1.046527051  0.15812565  1.525742654  1.1420337573   -0.73805920      1.04672289
## [48,]  1.10784999 -0.58752236 -0.89856839 -1.046527051  0.08810981  1.286069013  1.3622851335   -1.22016759      0.95936511
## [49,]  1.35420804 -0.28317542  0.12204803 -0.208094191  0.22814148  0.726830515  0.8917481025   -0.33630220      1.37868246
## [50,]  1.15712160 -0.54276546 -0.35180959 -0.627310621  0.57822065  0.934547672  1.5124565264   -0.33630220      0.85453577
## [51,]  0.06082829 -0.54276546 -1.19017308 -2.124512156 -0.54203270  0.678895787  1.2421480192   -1.54157319      2.30467493
## [52,]  1.02162467 -0.61437650  0.85105976 -0.687198682 -0.40200103  0.247483232  0.9618280859   -1.13981619      1.22143845
## [53,]  1.00930677 -0.52486270  0.19494920 -1.645407665  0.78826816  2.532371949  1.7126850502   -0.33630220      0.48763309
## [54,]  0.94771726 -0.39059199  1.14266445 -0.717142713  1.06833150  1.126286585  0.7615995621    0.22615759      0.15567353
## [55,]  0.91076355 -0.59647374 -0.42471076 -0.926750928  1.27837900  0.487156874  0.8717252502   -1.22016759      0.05084419
## [56,]  0.68904131 -0.54276546  0.34075155  0.300954331  1.13834733  1.062373614  0.7515881359   -1.30051899      1.50098335
## [57,]  1.50202286 -0.56961960 -0.24245783 -0.956694959  1.27837900  1.445851440  0.9718395121   -0.81841060      0.76717799
## [58,]  0.35645795 -0.32793232  1.14266445 -0.806974805  0.15812565  1.126286585  1.2021023145   -0.41665360      0.12073042
## [59,]  0.88612775 -0.81130688  0.48655389 -0.836918836  0.57822065  1.765416296  1.6426050669   -1.38087039      0.78464955
## [60,] -0.77678907 -1.24992453 -3.66881295 -2.663504709 -0.82209603 -0.503494178 -1.4609370523   -0.65770780     -2.04574255
## [61,] -0.82606067 -1.10670244 -0.31535901 -1.046527051  0.08810981 -0.391646479 -0.9403428904    2.15459116     -2.06321410
## [62,] -0.44420570 -0.87396654 -1.26307425 -0.806974805  0.01809398 -0.439581207 -0.6199772522    1.35107717     -1.69631142
## [63,]  0.82453824 -0.97243173 -1.62758012 -0.447646437 -0.40200103 -0.311755265 -0.2395430570   -0.33630220     -1.50412430
## [64,] -0.77678907 -1.07984830 -0.75276604 -0.148206130 -0.89211187  1.925198724  1.0719537740   -1.38087039      0.48763309
## [65,] -1.02314711 -0.79340412  0.59590565 -0.148206130  0.29815732 -0.647298363 -0.2795887618    0.70826598     -0.97997762
## [66,] -0.77678907 -1.00823725  0.70525741 -0.417702406 -0.12193769  0.199548504  0.6214395954    0.06545479      0.85453577
## [67,]  0.13473571 -1.18726487 -2.42949302 -1.345967358 -1.52225438  1.094330099  1.1520451835   -0.81841060      1.20396690
## [68,] -0.77678907 -1.04404278 -1.62758012  0.031458055 -1.52225438 -0.295777022 -0.0293031070   -0.73805920     -0.96250606
## [69,]  0.41804746 -1.24992453 -0.02375431 -0.747086744  0.71825232  0.375309174 -0.7301029403    1.51177997     -2.04574255
## [70,] -0.97387550 -1.02614002 -2.24724008 -0.806974805  3.58890153 -0.711211334 -0.7501257927   -1.78262739      1.58834113
## [71,] -0.87533228 -0.65018203 -0.57051311  0.271010300  0.22814148 -1.909579543 -1.0104228737    0.06545479     -0.22870071
## [72,]  1.05857838 -0.73969583  1.10621386  1.648435713 -0.96212770  1.046395371  0.8316795454   -1.22016759      0.48763309
## [73,]  0.60281600 -0.60542512 -0.46116135  1.348995406 -0.89211187 -0.663276606 -0.1894859260   -0.73805920     -0.97997762
## [74,] -0.01307912 -0.59647374  0.85105976  3.145637249  2.74871152  1.605633868  0.8617138240   -1.22016759      0.64487710
## [75,] -1.28182306 -1.11565382 -0.24245783  0.450674485  0.08810981  1.733459810  0.1108568597   -1.86297878      0.10325886
## [76,] -1.65136013 -0.40849475 -1.62758012 -1.046527051 -0.19195352 -1.094689161 -0.4597944332   -0.17559941     -0.77031895
##              Color         Hue    Dilution      Proline
##  [1,]  0.251008784  0.36115849  1.84272147  1.010159388
##  [2,] -0.292496232  0.40490846  1.11031723  0.962526349
##  [3,]  0.268262912  0.31740852  0.78636920  1.391223700
##  [4,]  1.182731669 -0.42634104  1.18074072  2.328006800
##  [5,] -0.318377423  0.36115849  0.44833648 -0.037767469
##  [6,]  0.729810822  0.40490846  0.33565890  2.232740722
##  [7,]  0.082781041  0.27365854  1.36384178  1.724654973
##  [8,] -0.003489596  0.44865844  1.36384178  1.740532653
##  [9,]  0.061213382  0.53615839  0.33565890  0.946648670
## [10,]  0.932546820  0.22990857  1.32158768  0.946648670
## [11,]  0.298457635  1.27990794  0.78636920  2.423272878
## [12,] -0.025057256  0.92990815  0.29340481  1.692899614
## [13,]  0.233754657  0.84240820  0.40608239  1.819921051
## [14,]  0.147484019  1.27990794  0.16664254  1.280079943
## [15,]  1.053325713  1.06115807  0.54692935  2.540767708
## [16,]  0.967055075  1.41115786  0.37791299  1.788165692
## [17,]  0.492566569  0.49240841  0.05396496  1.692899614
## [18,]  0.665107844  0.75490825 -0.05871261  1.216569224
## [19,]  1.570949537  1.19240799  0.29340481  2.963113987
## [20,]  0.018078063  0.01115870  1.05397844  0.311541483
## [21,]  0.255322316  0.57990836  1.54694284  0.105131647
## [22,] -0.240733849  0.31740852  1.27933359  0.073376288
## [23,] -0.542681081  0.66740831  1.95539905  0.914893310
## [24,] -0.486605166  0.57990836  1.43426526  0.851382592
## [25,] -0.663459973  0.71115828  1.70187450  0.311541483
## [26,] -0.637578782  0.75490825  0.82862329  0.263908444
## [27,] -0.111327893 -0.16384119  0.85679269  1.422979059
## [28,] -0.477978102  0.27365854  0.22298133  1.708777293
## [29,] -0.240733849  1.27990794  1.11031723  0.533828998
## [30,] -0.154463212  0.36115849  1.37792647  0.914893310
## [31,]  0.276889975  1.01740810  0.13847314  1.708777293
## [32,]  0.794513800  0.57990836  0.37791299  2.439150558
## [33,] -0.525426953  1.19240799  0.36382829  0.771994193
## [34,]  0.147484019  1.27990794  0.54692935  1.550000497
## [35,] -0.370139806  0.62365833  0.36382829  1.105425466
## [36,]  0.018078063  0.36115849  1.20891011  0.549706678
## [37,] -0.197598531  0.57990836  0.23706602  0.422685241
## [38,] -0.348572146  0.71115828 -0.14322079  1.137180826
## [39,] -0.585816399  0.97365812  0.11030375  0.867260271
## [40,]  0.018078063 -0.29509111  1.29341829  0.041620929
## [41,]  0.462371846 -0.03259127  1.08214784  0.152764686
## [42,] -0.335631551 -0.20759117  0.54692935  0.914893310
## [43,]  0.160424615 -0.33884109  1.33567238  1.105425466
## [44,] -0.301123296 -0.60134093  0.54692935 -0.212421946
## [45,] -0.007803128 -0.33884109  1.03989375  0.438562920
## [46,]  0.078467509 -0.38259106  1.01172435  1.057792427
## [47,] -0.068192574  0.36115849  1.16665602  1.010159388
## [48,]  0.449431250 -0.20759117  1.01172435  0.756116514
## [49,]  0.492566569  0.49240841  0.19481193  0.994281709
## [50,]  1.657220175  0.71115828  0.68777632  1.629388895
## [51,]  0.923919756  0.71115828  0.42016708  1.280079943
## [52,]  0.233754657  1.23615797  1.06806314  1.645266575
## [53,]  0.859216778  0.22990857  0.91313147  1.407101380
## [54,]  0.535701888  0.75490825  0.44833648  1.994575527
## [55,]  0.341592953 -0.16384119  0.82862329  0.994281709
## [56,]  0.514134228  0.09865865  0.58918345  1.184813865
## [57,]  0.570210143 -0.07634125  0.98355496  0.708483475
## [58,]  0.406295932  0.49240841  0.32157420  1.661144254
## [59,]  0.751378481 -0.29509111  0.36382829  1.708777293
## [60,] -1.340684477  0.40490846 -1.11506488 -0.720507695
## [61,] -0.771298270  1.27990794 -1.32633534 -0.212421946
## [62,]  0.298457635  0.09865865 -1.43901291 -0.942795210
## [63,] -0.542681081  1.19240799 -0.21364428 -0.371198742
## [64,] -0.262301509  1.14865802  0.36382829 -1.038061288
## [65,] -0.909331290  2.15490741 -0.53759231 -1.244471124
## [66,] -0.197598531  1.01740810 -0.43899943 -0.218773018
## [67,]  0.104348700  0.71115828  0.80045390 -0.777667342
## [68,] -0.163090276  0.71115828  1.22299481 -0.752263054
## [69,] -0.814433589  0.27365854 -0.96013322  0.009865569
## [70,] -0.952466609  1.41115786  0.64552223 -0.091751580
## [71,] -0.866195971 -0.22509116 -1.11506488  0.390929881
## [72,] -0.723849419  1.76115765  0.77228450 -1.069816648
## [73,] -0.568562272  0.09865865  0.23706602 -0.872933420
## [74,] -0.736790015  1.54240778  1.25116420  0.756116514
## [75,] -0.797179461  0.14240862  0.73003041  0.441738456
## [76,] -0.542681081  1.19240799 -0.66435458 -1.012657001
## [ reached getOption("max.print") -- omitted 102 rows ]
##attr(,"scaled:center")
##        Alcohol           Malic             Ash      Alcalinity       Magnesium         Phenols      Flavanoids   Nonflavanoids 
##     13.0006180       2.3363483       2.3665169      19.4949438      99.7415730       2.2951124       2.0292697       0.3618539 
##Proanthocyanins           Color             Hue        Dilution         Proline 
##      1.5908989       5.0580899       0.9574494       2.6116854     746.8932584 
##attr(,"scaled:scale")
##        Alcohol           Malic             Ash      Alcalinity       Magnesium         Phenols      Flavanoids   ##Nonflavanoids 
##      0.8118265       1.1171461       0.2743440       3.3395638      14.2824835       0.6258510       0.9988587       ##0.1244533 
##Proanthocyanins           Color             Hue        Dilution         Proline 
##      0.5723589       2.3182859       0.2285716       0.7099904     314.9074743


# Method 1: A plot of the total within-groups sums of squares against the 
# number of clusters in a K-means solution can be helpful. A bend in the 
# graph can suggest the appropriate number of clusters. 

```{r}
wssplot <- function(data, nc=15, seed = 1234){
+                 wss <- (nrow(data)-1)*sum(apply(data,2,var))
+                         for(i in 2:nc){
+             set.seed(seed)
+                 wss[i] <- sum(kmeans(data, centers = i)$withinss)}
+ 
+         plot(1:nc, wss, type="b", xlab="Number of Clusters",
+                                   ylab="Within groups of squares")
+     }
wssplot(scale_wine)
```

# Exercise 2:
#   * How many clusters does this method suggest?
#   * Why does this method work? What's the intuition behind it?
#   * Look at the code for wssplot() and figure out how it works

# Method 2: Use the NbClust library, which runs many experiments
# and gives a distribution of potential number of clusters.

## We performed the elbow method to find out the correct number of clusters (k value) for our dataset. The goal is to minimize the sum of squared errors  until the point where every additional cluster does not improve the SSE substantially. According to the graph we see that 3 clusters would be ideal for our wine dataset.

## This method does not work for all datasets. So plots do not have a clear "elbow" to determine the k values. They have a more gradual/smooth curve. For such datasets we have to find out other ways to determine the number of clusters required for our dataset.

### Method 2: Use the NbClust library, which runs many experiments
# and gives a distribution of potential number of clusters.

```{r}
library(NbClust)
set.seed(1234)
nc <- NbClust(df, min.nc=2, max.nc=15, method="kmeans")
barplot(table(nc$Best.n[1,]),
	          xlab="Numer of Clusters", ylab="Number of Criteria",
		            main="Number of Clusters Chosen by 26 Criteria")
```

# Exercise 3: How many clusters does this method suggest?
##This method suggest 2 clusters

# Exercise 4: Once you've picked the number of clusters, run k-means 
# using this number of clusters. Output the result of calling kmeans()
# into a variable fit.km


```{r}
fit.km <- kmeans(scale_wine, centers = 3, iter.max = 10)
str(fit.km)
```

##List of 9
## $ cluster     : int [1:178] 2 2 2 2 2 2 2 2 2 2 ...
## $ centers     : num [1:3, 1:13] -0.923 0.833 0.164 -0.393 -0.303 ...
##  ..- attr(*, "dimnames")=List of 2
##  .. ..$ : chr [1:3] "1" "2" "3"
##  .. ..$ : chr [1:13] "Alcohol" "Malic" "Ash" "Alcalinity" ...
## $ totss       : num 2301
## $ withinss    : num [1:3] 559 386 326
## $ tot.withinss: num 1271
## $ betweenss   : num 1030
## $ size        : int [1:3] 65 62 51
## $ iter        : int 3
## $ ifault      : int 0
## - attr(*, "class")= chr "kmeans"

# Now we want to evaluate how well this clustering does.

# Exercise 5: using the table() function, show how the clusters in fit.km$clusters
# compares to the actual wine types in wine$Type. Would you consider this a good
# clustering?

```{r}
table(fit.km$cluster)
table(wine$Type)
```   
## 1  2  3 
## 65 62 51 

##  1  2  3 
## 59 71 48 

##

# Exercise 6:
# * Visualize these clusters using  function clusplot() from the cluster library
# * Would you consider this a good clustering?

```{r}
clusplot(wine, fit.km$cluster, main = "Clusplot")
```

## I would think this is a good clustering as different types of wines are part of their specific clusters without much overlap.